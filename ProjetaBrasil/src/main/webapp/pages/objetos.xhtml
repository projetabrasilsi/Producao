<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:cc="http://java.sun.com/jsf/composite"
	template="/templates/template.xhtml">
	<h:head>
		<h:outputStylesheet library="css" name="clubefidelidadee.css" />
		<script src="http://code.jquery.com/jquery-2.1.1.min.js"></script>
		<script type="text/javascript" src="./js/pessoas.js" />
	</h:head>
	<f:event listener="#{paginas.mudaPaginaAtual}" type="preRenderView" />
	<ui:define name="conteudo">

		<h:form id="formLista">

			<p:panel id="painelgeral"
				header="Listagem de Animais/Objetos/Pessoas. Proprietário(#{ObjetojsfController.pessoa.descricao})">
				<p:dataTable id="tabela" emptyMessage="" reflow="true"
					value="#{objetojsfController.objetos}" paginator="true" rows="5"
					var="registro" style="font-size:15px;">
					<f:facet name="header">

						<p:commandButton value="Novo"
							actionListener="#{objetojsfController.novo}" process="@form"
							update=":formTemplate:formCadastro" style="width:5%">
						</p:commandButton>
					</f:facet>

					<p:column headerText="Foto">
						<p:graphicImage id="Fototab" value="#{imagensjsfController.image}"
							style="max-width:90px;max-height:80px;width: auto;height: auto;">
							<f:param name="caminho" value="#{registro.caminhodaImagem}" />
						</p:graphicImage>
					</p:column>

					<p:column headerText="Descricao" sortBy="descricao"
						filterBy="descricao">
						<h:outputText value="#{registro.descricao}" />
					</p:column>

					<p:column headerText="Ano" sortBy="ano_objeto"
						filterBy="ano_objeto">
						<h:outputText value="#{registro.ano_Objeto}" />
					</p:column>

					<p:column headerText="Marca/Raça"
						sortBy="registro.id_Marca_e_Raca.descricao"
						filterBy="registro.id_Marca_e_Raca.descricao">
						<h:outputText value="#{registro.id_Marca_e_Raca.descricao}" />
					</p:column>

					<p:column headerText="Cor" sortBy="cor" filterBy="cor">
						<h:outputText value="#{registro.cor.descricao}" />
					</p:column>

					<p:column headerText="Editar" style="width:5%;">


						<p:commandButton icon="ui-icon-pencil"
							actionListener="#{objetojsfController.editar}"
							rendered="#{autenticacaojsfController.perfilLogado.renderizapessoaeditar}"
							update=":formTemplate:formCadastro :formTemplate:formCadastro
							">
							<p:confirm header="Confirmacao"
								message="Deseja realmente alterar este registro?"
								icon="ui-icon-alert" style="width:5%" />

							<f:attribute name="registroAtual" value="#{registro}" />
						</p:commandButton>
					</p:column>

				</p:dataTable>
				<p:confirmDialog global="true">
					<p:commandButton value="SIM" type="button"
						styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
					<p:commandButton value="NAO" type="button"
						styleClass="ui-confirmdialog-no" icon="ui-icon-close" />

				</p:confirmDialog>
			</p:panel>
		</h:form>

		<p:dialog widgetVar="dialogoIdentidade" closable="false"
			resizable="false" modal="true" appendTo="@(body)"
			header="Escolha o Tipo de Identificação" dynamic="true"
			responsive="true" styleClass="dialog-cpf-pessoas">

			<h:form id="formIdentidade">

				<p:focus for="identificador" />
				<p:selectOneRadio id="perfil"
					value="#{objetojsfController.pessoa.enum_Aux_Tipo_Identificador}"
					layout="pageDirection" columns="5"
					converter="omnifaces.SelectItemsConverter">
					<f:selectItems
						value="#{objetojsfController.pessoaConfig.listaTipodeIdentificadores}"
						var="c" itemLabel="#{c.descricao}" itemValue="#{c}" />
					<p:ajax event="change" update="identificador" process="@this"
						oncomplete="$(function(){PrimeFaces.focus('formTemplate:formIdentidade:identificador');});" />
				</p:selectOneRadio>

				<div class="ui-g-12">
					<p:outputLabel value="Informe CPF/CNPJ " />
					<p:inputMask id="identificador" size="30" maxlength="20"
						value="#{objetojsfController.pessoa.cpf_Cnpj}" required="true"
						requiredMessage="É preciso informar a identificação!!!"
						mask="#{objetojsfController.pessoa.enum_Aux_Tipo_Identificador.mask}"
						styleClass="input-cpf-pessoas" />
				</div>

				<div class="ui-g-5">
					<p:commandButton value="Validar"
						actionListener="#{objetojsfController.buscaPessoa}"
						process="@form"
						update=":mensagens :formTemplate:formLista:tabela   :formTemplate:formLista:painelgeral "
						styleClass="btn-color-blue2">
					</p:commandButton>
				</div>
				<div class="ui-g-5">
					<p:commandButton value="Cancelar" process="@this"
						actionListener="#{objetojsfController.cancelaValidacao}"
						styleClass="btn-color-blue2">
					</p:commandButton>
				</div>
			</h:form>
		</p:dialog>

		<p:dialog
			header="Formulário de Cadastro - #{autenticacaojsfController.perfilLogado.paginaAtual.classificacaoObjeto.descricao}"
			widgetVar="dialogoCadastro" resizable="false" modal="true"
			closable="false" appendTo="@(body)" dynamic="true" responsive="true"
			style="float: left;
    padding: 10px;
    font-family: calibri;
    color: #6495ED;
    font-size: 15px;
    text-align: left;overflow:auto;">
			<h:form id="formCadastro">

				<p:wizard widgetVar="wiz" nextLabel="Próximo" backLabel="Anterior"
					styleClass="wizard-info-pessoas">


					<p:tab id="tab1" title="Dados Base">
						<p:panel id="p_d_p">
								
							<h:form id="painelCadastro_6">
								<div class="ui-g row-tab1">	
									<div class="grupo1-info-pessoas-tab1">
										<div class="ui-g-2">
											<p:outputLabel value="Descrição do Objeto:" />
											<br/>
											<p:inputText size="15" maxlength="30"
												value="#{objetojsfController.objeto.descricao}" required="true"
												requiredMessage="Descrição do objeto é obrigatória"
												validatorMessage="O minimo de caracteres para nome são  '3'"
												placeholder="Mínimo 3 Letras">
												<f:validateLength minimum="3" />
											</p:inputText>
										</div>
		
										<div class="ui-g-2">
											<p:outputLabel value="Raça / Marca:" />
											<br/>
											<p:selectOneMenu id="raca_marca"
												converter="omnifaces.SelectItemsConverter"
												value="#{objetojsfController.objeto.id_Marca_e_Raca}"
												rendered="true">
												<f:selectItem itemLabel="selecione" itemValue=""
													noSelectionOption="true" />
												<f:selectItems value="#{objetojsfController.listaRacaMarca}"
													var="o" itemLabel="#{o.descricao}" itemValue="#{o}" />
												<p:ajax listener="#{objetojsfController.listarModelo}"
													update="modelo" />
											</p:selectOneMenu>
											<p:commandButton value=". . ."
												actionListener="#{objetojsfController.novaRaca}"
												process="@this" styleClass="btn-info-objetos-cor" />
										</div>
										
										<div class="ui-g-2">
											<p:outputLabel value="Modelo:"
												rendered="#{objetojsfController.renderizaPorClassificacao()}" />
											<br/>
											<p:selectOneMenu id="modelo"
												converter="omnifaces.SelectItemsConverter"
												value="#{objetojsfController.objeto.id_Modelo_de_Marca_e_Raca}"
												rendered="#{objetojsfController.renderizaPorClassificacao()}">
												<f:selectItem itemLabel="selecione" itemValue=""
													noSelectionOption="true" />
												<f:selectItems value="#{objetojsfController.listaModelo}"
													var="o" itemLabel="#{o.descricao}" itemValue="#{o}" />
											</p:selectOneMenu>
										</div>
									</div>
								</div>
								
								<div class="ui-g row-tab1">	
									<div class="grupo2-info-pessoas-tab1">
										<div class="ui-g-2">
											<p:outputLabel value="Sexo:"
											rendered="#{objetojsfController.renderizaSeForPet()}" />
											<br/>
											<p:selectOneRadio id="sexo"
												rendered="#{objetojsfController.renderizaSeForPet()}"
												value="#{objetojsfController.objeto.sexo}" columns="3"
												converter="omnifaces.SelectItemsConverter">
												<f:selectItems value="#{objetojsfController.listaSexo}" var="c"
													itemLabel="#{c.abrev}" itemValue="#{c}" />
											</p:selectOneRadio>
										</div>
										
										<div class="ui-g-2">
											<p:outputLabel value="Cor:" />
											<br/>
											<p:selectOneMenu id="cor"
												converter="omnifaces.SelectItemsConverter"
												value="#{objetojsfController.objeto.cor}" rendered="true">
												<f:selectItem itemLabel="selecione" itemValue=""
													noSelectionOption="true" />
												<f:selectItems value="#{objetojsfController.listaCor}" var="o"
													itemLabel="#{o.descricao}" itemValue="#{o}" />
											</p:selectOneMenu>											
											<br/>
											<p:commandButton value=". . ."
												actionListener="#{objetojsfController.novaCor}" process="@this"
												styleClass="btn-info-objetos-cor"
												update=":mensagens :formTemplate:formCadastro:painelCadastro_6:modelo" />
										</div>
										
										<div class="ui-g-2">
											<p:outputLabel value="#{objetojsfController.labelAno}" />
											<p:inputMask id="ano"
												value="objetojsfController.objeto.ano_objeto" mask="9999" />
										</div>
									</div>
								</div>
	
								<h:panelGrid id="pF">
									<p:outputLabel for="upload" value="Buscar e carregar Foto:" />
									<p:fileUpload id="upload" mode="advanced"
										fileUploadListener="#{objetojsfController.upload}"
										update=":mensagens :formTemplate:formCadastro:painelCadastro_6:foto" auto="true"
										style="font-size:15px;width:490px; "
										allowTypes="/(\.|\/)(#{objetojsfController.tipoDeImagem})$/">
										<p:graphicImage />
									</p:fileUpload>
									<p:graphicImage id="foto" value="#{imagensjsfController.image}"
										style="max-width:90px; max-height:80px; width: auto; height: auto;">
										<f:param name="caminho"
											value="#{objetojsfController.objeto.caminhodaImagem}" />
									</p:graphicImage>
								</h:panelGrid>
		
								<h:panelGrid columns="2" id="painelCadastro_7">
									<p:panelGrid>
										<p:commandButton value="Salvar" process="@form"
											rendered="#{objetojsfController.renderizaPorClassificacao()}"
											actionListener="#{objetojsfController.merge}"
											update=":mensagens :formTemplate:formLista:tabela" />
									</p:panelGrid>
									<p:panelGrid>
										<p:commandButton value="Cancelar" process="@this"
											actionListener="#{objetojsfController.cancela}" />
									</p:panelGrid>
								</h:panelGrid>
							</h:form>
						</p:panel>
					</p:tab>

					<p:tab id="tab2" title="Prontuário de Emergência"
						rendered="#{objetojsfController.renderizaSeForPet()}">
						<p:panel id="p_prontuario_emergencia">

							<h:panelGrid columns="1" render="@form">
								<p:outputLabel value="Tipo de Prontuario:" />

								<h:panelGrid columns="1" render="@form">
									<p:selectOneMenu id="tipoProntuario"
										converter="omnifaces.SelectItemsConverter"
										value="#{objetojsfController.tipoProntuarioEmergencia}"
										rendered="true">
										<f:selectItem itemLabel="selecione" itemValue=""
											noSelectionOption="true" />
										<f:selectItems
											value="#{objetojsfController.listaTiposProntuarioEmergencia}"
											var="o" itemLabel="#{o.descricao}" itemValue="#{o}" />
									</p:selectOneMenu>

									<p:outputLabel value="descreva:" />
									<p:inputText id="descricaoEmergencia" size="27" maxlength="30"
										value="#{objetojsfController.descricaoProntuario}" />

									<p:commandButton value="Adicionar" process="@form"
										actionListener="#{objetojsfController.incluirProntuarioEmergenciaNaLista}"
										styleClass="btn-info-pessoas-add-cell btn-info-pessoas-add-cell-tab4 btn-color-green2"
										update=":mensagens :formTemplate:formCadastro:formListaProntuario:tabelaProntuario" />


								</h:panelGrid>
							</h:panelGrid>

							<div class="div-tb-wizard-tab3">
								<h:form id="formListaProntuario">
									<p:dataTable id="tabelaProntuario" emptyMessage="Sem Registros"
										resizableColumns="true"
										value="#{objetojsfController.listaProntuarioEmergencia}"
										paginator="true" rows="4" var="registro"
										styleClass="tabela-pessoas">

										<p:column headerText="Classificação"
											sortBy="registro.tipo_Prontuario_Emergencia.descricao"
											filterBy="tipo_Prontuario_Emergencia.descricao"
											styleClass="geral-col-pessoas">
											<h:outputText
												value="#{registro.tipo_Prontuario_Emergencia.descricao}" />
										</p:column>

										<p:column headerText="Descricao" sortBy="registro.descricao"
											filterBy="descricao" styleClass="geral-col-pessoas">
											<h:outputText value="#{registro.descricao}" />
										</p:column>


										<p:column headerText="Excluir"
											styleClass="excl-col-info-pessoas">
											<p:commandButton icon="ui-icon-trash" process="@form"
												actionListener="#{objetojsfController.excluirProntuario}"
												update=":formTemplate:formCadastro:formListaProntuario:tabelaProntuario"
												styleClass="excl-btn-info-pessoas btn-color-red">
												<p:confirm header="Confirmação"
													message="Deseja realmente excluir este registro?"
													icon="ui-icon-alert" />
												<f:attribute name="registroAtualProntuario"
													value="#{registro}" />
											</p:commandButton>
										</p:column>
									</p:dataTable>
								</h:form>
							</div>

						</p:panel>
					</p:tab>
					<p:tab id="tab3" title="Vacina"
						rendered="#{objetojsfController.renderizaVacina()}">
						<h:panelGrid>
							<p:outputLabel value="Tipo de Vacina/Medicacao:" />

							<h:panelGrid columns="1" render="@form">
								<p:selectOneMenu id="tipoVacina"
									converter="omnifaces.SelectItemsConverter"
									value="#{objetojsfController.tipoVacina}" rendered="true">
									<f:selectItem itemLabel="selecione" itemValue=""
										noSelectionOption="true" />
									<f:selectItems value="#{objetojsfController.listaTiposVacina}"
										var="o" itemLabel="#{o.descricao}" itemValue="#{o}" />
								</p:selectOneMenu>

								<p:outputLabel value="Data de vacina/medicação" />
								<br />
								<p:calendar id="calendar" size="18" maxlength="15"
									mask="**/**/****" pattern="dd/MM/yyyy"
									value="#{objetojsfController.dataVacina}"
									styleClass="input-info-pessoas-data">
									<f:convertDateTime pattern="dd/MM/yyyy" dateStyle="full"
										type="both" timezone="GMT+3" />
								</p:calendar>

								<p:outputLabel value="Veterinário responsável:" />

								<h:panelGrid columns="1" render="@form">
									<p:selectOneMenu id="veterinarioResponsavel"
										converter="omnifaces.SelectItemsConverter"
										value="#{objetojsfController.id_veterinario_responsavel}"
										rendered="true">
										<f:selectItem itemLabel="selecione" itemValue=""
											noSelectionOption="true" />
										<f:selectItems
											value="#{objetojsfController.listaVeterinariosDaClinica}"
											var="o" itemLabel="#{o.descricao}" itemValue="#{o}" />
									</p:selectOneMenu>

									<p:commandButton value="Adicionar" process="@form"
										actionListener="#{objetojsfController.incluirVacinaNaLista}"
										styleClass="btn-info-pessoas-add-cell btn-info-pessoas-add-cell-tab4 btn-color-green2"
										update=":mensagens :formTemplate:formCadastro:formListaVacina:tabelaVacina" />


								</h:panelGrid>
							</h:panelGrid>
						</h:panelGrid>

						<div class="div-tb-wizard-tab3">
							<h:form id="formListaVacina">
								<p:dataTable id="tabelaVacina" emptyMessage="Sem Registros"
									resizableColumns="true"
									value="#{objetojsfController.listaVacina}" paginator="true"
									rows="4" var="registro" styleClass="tabela-pessoas">

									<p:column headerText="Descricao" sortBy="registro.descricao"
										filterBy="descricao" styleClass="geral-col-pessoas">
										<h:outputText value="#{registro.descricao}" />
									</p:column>

									<p:column id="date" headerText="Data"
										filterBy="#{objetojsfController.dataVacina.time}">
										<f:facet name="filter">
											<h:inputHidden />
										</f:facet>

										<h:outputText value="#{registro.dataVacinacao}">
											<f:convertDateTime locale="pt_BR" dateStyle="long"
												type="both" pattern="dd/MM/yyyy"/>
										</h:outputText>
										
									</p:column>							

									<p:column headerText="Excluir"
										styleClass="excl-col-info-pessoas">
										<p:commandButton icon="ui-icon-trash" process="@form"
											actionListener="#{objetojsfController.excluirVacina}"
											update=":formTemplate:formCadastro:formListaVacina:tabelaVacina"
											styleClass="excl-btn-info-pessoas btn-color-red">
											<p:confirm header="Confirmação"
												message="Deseja realmente excluir este registro?"
												icon="ui-icon-alert" />
											<f:attribute name="registroAtualVacina" value="#{registro}" />
										</p:commandButton>
									</p:column>
								</p:dataTable>
							</h:form>
						</div>

						<p:commandButton value="Salvar" process="@this"
							oncomplete="PF('wiz').loadStep('tab1', true)"
							styleClass="btao-info-pessoas"
							actionListener="#{objetojsfController.merge}"
							update=":mensagens :formTemplate:formLista:tabela" />




					</p:tab>

				</p:wizard>

			</h:form>
		</p:dialog>

		<p:dialog header="Adicionar Cor" widgetVar="dialogoCadastroCor"
			resizable="false" modal="true" closable="false" appendTo="@(body)"
			dynamic="true" responsive="true" styleClass="dialog-wizard-tab2">

			<h:form id="formCadastroCor">
				<h:panelGrid id="painelCadastro_115">

					<h:panelGrid id="painelCadastro_114">
						<p:outputLabel value="Descrição da Cor" />
						<p:inputText size="30" maxlength="30"
							value="#{objetojsfController.cor.descricao}" required="true"
							requiredMessage="Descrição da cor é obrigatória"
							validatorMessage="O minimo de caracteres para nome são  '4'"
							placeholder="Mínimo 4 Letras">
							<f:validateLength minimum="4" />
						</p:inputText>
					</h:panelGrid>

					<h:panelGrid columns="2" styleClass="btn-grid-dialog-tab2-wizard">
						<p:commandButton value="Adicionar"
							update=":formTemplate:formCadastro:painelCadastro_6:cor"
							actionListener="#{objetojsfController.adicionarCor}"
							process="@form" styleClass="btao-objetos">
						</p:commandButton>

						<p:commandButton value="Cancelar"
							onclick="PF('dialogoCadastroCor').hide();"
							styleClass="btao-objetos">
						</p:commandButton>
					</h:panelGrid>
				</h:panelGrid>
			</h:form>

		</p:dialog>

		<p:dialog header="Adicionar Raça" widgetVar="dialogoCadastroRaca"
			resizable="false" modal="true" closable="false" appendTo="@(body)"
			dynamic="true" responsive="true" styleClass="dialog-wizard-tab2">

			<h:form id="formCadastroRaca">
				<h:panelGrid id="painelCadastro_115">

					<h:panelGrid id="painelCadastro_114">
						<p:outputLabel value="Descrição da Raça" />
						<p:inputText size="30" maxlength="30"
							value="#{objetojsfController.raca.descricao}" required="true"
							requiredMessage="Descrição da raça é obrigatória"
							validatorMessage="O minimo de caracteres para nome são  '4'"
							placeholder="Mínimo 4 Letras">
							<f:validateLength minimum="4" />
						</p:inputText>
					</h:panelGrid>

					<h:panelGrid columns="2" styleClass="btn-grid-dialog-tab2-wizard">
						<p:commandButton value="Adicionar"
							update=":formTemplate:formCadastro:painelCadastro_6:raca_marca"
							actionListener="#{objetojsfController.adicionarRaca}"
							process="@form" styleClass="btao-objetos">
						</p:commandButton>

						<p:commandButton value="Cancelar"
							onclick="PF('dialogoCadastroRaca').hide();"
							styleClass="btao-objetos">
						</p:commandButton>
					</h:panelGrid>
				</h:panelGrid>
			</h:form>

		</p:dialog>

	</ui:define>
</ui:composition>